### Implementation of Fourier Neural Operators for the 1D FitzHugh–Nagumo System

This repository contains the code developed for my **Bachelor thesis project**, entitled  
*“Approximating Cardiac Action Potentials from the FitzHugh–Nagumo Model Using a Fourier Neural Operator : A Theoretical and Practical Study”*.  
The work combines theoretical insights on operator learning with a practical implementation of a **Fourier Neural Operator (FNO)** in Python, applied to a simplified model of cardiac action potentials.

---

#### 🧬 Overview

The goal of this project is to train an FNO to approximate solutions of the **1D FitzHugh–Nagumo system**, a reduced model of excitable media such as cardiac tissue.  
The repository includes code for data generation, preprocessing, model definition, training, and evaluation, as well as scripts for hyperparameter exploration and visualization.

---

#### 📊 Data generation in `Data/FitzHugh_Nagumo/`

- Synthetic datasets are generated by numerically integrating the FitzHugh–Nagumo system with RADAU method.  
- The resulting trajectories are normalized (minmax) and stored in `./data_tensors/`.   
- For file size reasons, only the reduced version (`*_red.pt`) is stored here (500 points for each input and output curves).
- To fully regenerate the dataset, please run the following scripts in `./Data_generation/` in the following order:
  1. `dataset_generation.py` – generates the full dataset and stores it as a dictionary of simulation results.
  2. `conversion_into_data_tensors.py` – converts the dictionary into PyTorch tensor files for training and validation.
  3. `normalization_minmax.py` – applies min–max normalization across all samples.
  4. `reduction_number_points.py` – reduces the temporal resolution to produce lighter dataset versions (*_red.pt).

These steps ensure a clean and reproducible data pipeline from raw numerical simulations to model-ready tensors.

---

#### 🧠 FNO Implementation in `FNO/FitzHugh_Nagumo/`

- The core model is based on the **`neuralop`** library’s implementation of the **Fourier Neural Operator**.  
- Training routines, loss functions, and evaluation metrics are defined in `./FNO.py`. 
- `./Test_FNO.py` evaluates the trained model on the test set. It also includes code for visualizing a few representative test samples to assess the model’s qualitative performance.
- The file `./FNO_Hyperparameters.py` performs a two-step hyperparameter search using **Ray Tune** (quick grid search followed by fine-tuning on the top configurations).

---

#### 🏆 Best Paths in `best_paths/`

- At the end of training, for each manual variation of hyperparameters, the best-performing configuration (i.e., the one achieving the lowest validation loss during training) is saved in the `best_paths` folder.
Each model is stored following the naming convention:
`best_fno_model_minmax_modeA_hcB_layersC_bzD_seedE.pth`
where
  - A = number of modes (`n_modes`),
  - B = number of hidden channels (`hidden_channels`),
  - C = number of layers (`n_layers`),
  - D = batch size (`batch_size`), and
  - E = random seed (`seed`).
- These different models can be tested and visualized in `Test_FNO.py` by adjusting the hyperparameters in the code (lines 14, 35, 52, 53, and 57) and specifying the corresponding model path at line 61.

---

#### ⚙️ Additional Tests: Dahlquist Equation

Most of the code (except for the hyperparameter search) has also been adapted to the **Dahlquist equation**.  
This simplified linear test case was used to perform controlled experiments and verify the FNO’s numerical behavior under idealized conditions.

---

#### 🧾 Requirements

To run the code, install the main dependencies:

```bash
pip install torch neuraloperator ray matplotlib numpy
```
GPU acceleration is recommended for training.

---
#### 📁 Repository Structure

```text
.
├── Data/                         # Data generation and preprocessing scripts
│   ├──Dahlquist/                 # Data generation for Dahlquist equation
│   ├──FitzHugh_Nagumo/           # Data generation for FitzHugh-Nagumo equation
│   │   ├──Data_generation/       # Data generation routine 
│   │   └──Data_tensors/          # Preprocessed reduced tensors       
├── FNO/                          # Model definitions and training routines
│   ├──Dahlquist/                 # Model for Dahlquist equation
│   ├──FitzHugh_Nagumo/           # Model for FitzHugh-Nagumo equation
│   │   ├──Plots/                 # Visualizations 
│   │   ├──FNO.py                 # Training model
│   │   ├──FNO_Hyperparameters.py # Best hyperparameters search
│   │   ├──parameters_count.py    # Count of the number of parameters in each model
│   │   └──Test_FNO.py            # Evaluation of the trained model on the test set
├── best_paths                    # Saved best configurations
└── README.md                     # Project overview
```

#### 📚 Reference

This work was carried out as part of my **Bachelor thesis** at **UniDistance Suisse**,  
under the supervision of **Dr. Marco Favino** and **Prof. Rolf Krause** *(October 2025)*.

